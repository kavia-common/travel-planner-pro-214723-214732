{"is_source_file": true, "format": "Python", "description": "This file defines API routes for managing itinerary items within a trip for a travel planning backend, utilizing FastAPI, SQLAlchemy, and Pydantic schemas. It includes route handlers for listing, creating, retrieving, updating, and deleting itinerary items scoped to specific trip IDs, along with internal helper functions for fetching trips and itinerary items or raising 404 errors.", "external_files": ["src/db/models", "src/db/session", "src/schemas/travel"], "external_methods": ["get_db", "func.count", "select"], "published": ["list_itinerary_items", "create_itinerary_item", "get_itinerary_item", "update_itinerary_item", "delete_itinerary_item"], "classes": [{"name": "ItineraryItemUpdate", "description": "Schema for updating an itinerary item with optional fields, used for partial updates."}, {"name": "ItineraryItemListResponse", "description": "Response model for paginated listing of itinerary items, including total count and list of items."}], "methods": [{"name": "Trip _get_trip_or_404(db: Session, trip_id: uuid.UUID)", "description": "Fetch a trip by id or raise 404 if not found.", "scope": "", "scopeKind": ""}, {"name": "ItineraryItem _get_itinerary_item_or_404(db: Session, trip_id: uuid.UUID, item_id: uuid.UUID)", "description": "Fetch an itinerary item by id scoped to a trip, or raise 404 if not found.", "scope": "", "scopeKind": ""}, {"name": "ItineraryItemRead create_itinerary_item( trip_id: uuid.UUID, payload: ItineraryItemCreate, db: Session = Depends(get_db), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Response delete_itinerary_item( trip_id: uuid.UUID, item_id: uuid.UUID, db: Session = Depends(get_db), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ItineraryItemRead get_itinerary_item( trip_id: uuid.UUID, item_id: uuid.UUID, db: Session = Depends(get_db), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ItineraryItemListResponse list_itinerary_items( trip_id: uuid.UUID, db: Session = Depends(get_db), limit: int = Query(50, ge=1, le=100, description=\"Maximum number of itinerary items to return\"), offset: int = Query(0, ge=0, description=\"Number of itinerary items to skip\"), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ItineraryItemRead update_itinerary_item( trip_id: uuid.UUID, item_id: uuid.UUID, payload: ItineraryItemUpdate, db: Session = Depends(get_db), )", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["db.get", "db.execute", "db.add", "db.commit", "db.refresh", "db.delete", "select", "func.count", "select().where()", "select().order_by()"], "search-terms": ["itinerary", "trip_id", "CRUD", "FastAPI routes", "ItineraryItem", "list_itinerary_items", "create_itinerary_item", "update_itinerary_item", "delete_itinerary_item"], "state": 2, "file_id": 12, "knowledge_revision": 28, "git_revision": "ecf650be19989ce9e76519555ca2aa3dbc65a383", "revision_history": [{"27": ""}, {"28": "ecf650be19989ce9e76519555ca2aa3dbc65a383"}], "ctags": [{"_type": "tag", "name": "ItineraryItemListResponse", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^class ItineraryItemListResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ItineraryItemUpdate", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^class ItineraryItemUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_get_itinerary_item_or_404", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def _get_itinerary_item_or_404(db: Session, trip_id: uuid.UUID, item_id: uuid.UUID) -> Itinerary/", "language": "Python", "typeref": "typename:ItineraryItem", "kind": "function", "signature": "(db: Session, trip_id: uuid.UUID, item_id: uuid.UUID)"}, {"_type": "tag", "name": "_get_trip_or_404", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def _get_trip_or_404(db: Session, trip_id: uuid.UUID) -> Trip:$/", "language": "Python", "typeref": "typename:Trip", "kind": "function", "signature": "(db: Session, trip_id: uuid.UUID)"}, {"_type": "tag", "name": "create_itinerary_item", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def create_itinerary_item($/", "language": "Python", "typeref": "typename:ItineraryItemRead", "kind": "function", "signature": "( trip_id: uuid.UUID, payload: ItineraryItemCreate, db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "day", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    day: Optional[int] = Field(None, description=\"Day number within trip (1..N)\", ge=1)$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "delete_itinerary_item", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def delete_itinerary_item($/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "( trip_id: uuid.UUID, item_id: uuid.UUID, db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    description: Optional[str] = Field(None, description=\"Details\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "destination_id", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    destination_id: Optional[uuid.UUID] = Field(None, description=\"Optional destination UUID\")$/", "language": "Python", "typeref": "typename:Optional[uuid.UUID]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "end_time", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    end_time: Optional[\"datetime\"] = Field(None, description=\"End datetime (optional)\")  # type:/", "language": "Python", "typeref": "typename:Optional[\"datetime\"]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "get_itinerary_item", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def get_itinerary_item($/", "language": "Python", "typeref": "typename:ItineraryItemRead", "kind": "function", "signature": "( trip_id: uuid.UUID, item_id: uuid.UUID, db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    items: list[ItineraryItemRead] = Field(..., description=\"Itinerary items in the current page/", "language": "Python", "typeref": "typename:list[ItineraryItemRead]", "kind": "variable", "scope": "ItineraryItemListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "limit", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    limit: int = Field(..., description=\"Page size limit used for this response\", ge=1, le=100)$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "ItineraryItemListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "list_itinerary_items", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def list_itinerary_items($/", "language": "Python", "typeref": "typename:ItineraryItemListResponse", "kind": "function", "signature": "( trip_id: uuid.UUID, db: Session = Depends(get_db), limit: int = Query(50, ge=1, le=100, description=\"Maximum number of itinerary items to return\"), offset: int = Query(0, ge=0, description=\"Number of itinerary items to skip\"), )"}, {"_type": "tag", "name": "offset", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    offset: int = Field(..., description=\"Offset used for this response\", ge=0)$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "ItineraryItemListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^router = APIRouter($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "start_time", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    start_time: Optional[\"datetime\"] = Field(None, description=\"Start datetime (optional)\")  # t/", "language": "Python", "typeref": "typename:Optional[\"datetime\"]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    title: Optional[str] = Field(None, description=\"Itinerary item title\", max_length=200)$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "ItineraryItemUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^    total: int = Field(..., description=\"Total number of itinerary items available for the trip /", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "ItineraryItemListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "update_itinerary_item", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/itinerary.py", "pattern": "/^def update_itinerary_item($/", "language": "Python", "typeref": "typename:ItineraryItemRead", "kind": "function", "signature": "( trip_id: uuid.UUID, item_id: uuid.UUID, payload: ItineraryItemUpdate, db: Session = Depends(get_db), )"}], "hash": "e66f12899f42c7f4ee4bd8a2ffdb2477", "format-version": 4, "code-base-name": "travel_planner_backend", "filename": "travel_planner_backend/src/api/routes/itinerary.py", "fields": [{"name": "Optional[int] day", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] description", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[uuid.UUID] destination_id", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[\"datetime\"] end_time", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "list[ItineraryItemRead] items", "scope": "ItineraryItemListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int limit", "scope": "ItineraryItemListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int offset", "scope": "ItineraryItemListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[\"datetime\"] start_time", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] title", "scope": "ItineraryItemUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "int total", "scope": "ItineraryItemListResponse", "scopeKind": "class", "description": "unavailable"}]}