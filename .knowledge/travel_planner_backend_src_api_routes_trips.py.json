{"is_source_file": true, "format": "Python", "description": "This file defines API routes for managing 'Trip' entities in a travel planning backend service. It includes route handlers for listing, creating, retrieving, updating, and deleting trips, as well as related data models, validation logic, and utility functions.", "external_files": ["src/db/models.py", "src/db/session.py", "src/schemas/travel.py"], "external_methods": ["get_db", "Trip", "TripCreate", "TripRead"], "published": ["list_trips", "create_trip", "get_trip", "update_trip", "delete_trip"], "classes": [{"name": "TripUpdate", "description": "Schema for updating a trip with optional fields, including validation to prevent blank names."}, {"name": "TripListResponse", "description": "Response model for paginated list of trips, including total count, limit, offset, and items."}], "methods": [{"name": "Select[tuple[Trip]] _apply_trip_sorting( stmt: Select[tuple[Trip]], *, sort_by: Literal[\"created_at\", \"name\"] = \"created_at\", sort_dir: Literal[\"asc\", \"desc\"] = \"desc\", )", "description": "Applies sorting to a SQLAlchemy select statement based on specified sort field and direction.", "scope": "", "scopeKind": ""}, {"name": "Trip _get_trip_or_404(db: Session, trip_id: uuid.UUID)", "description": "Fetches a Trip by ID or raises a 404 HTTP exception if not found.", "scope": "", "scopeKind": ""}, {"name": "list_trips( db: Session = Depends(get_db), limit: int = Query(20, ge=1, le=100, description=\"Maximum number of trips to return\"), offset: int = Query(0, ge=0, description=\"Number of trips to skip\"), sort_by: Literal[\"created_at\", \"name\"] = Query( \"created_at\", description=\"Sort field\", ), sort_dir: Literal[\"asc\", \"desc\"] = Query( \"desc\", description=\"Sort direction\", ), )", "description": "Handles GET requests to list trips with pagination and sorting options.", "scope": "", "scopeKind": ""}, {"name": "TripRead create_trip(payload: TripCreate, db: Session = Depends(get_db))", "description": "Handles POST requests to create a new trip, validating date constraints.", "scope": "", "scopeKind": ""}, {"name": "TripRead get_trip(trip_id: uuid.UUID, db: Session = Depends(get_db))", "description": "Handles GET requests to retrieve a specific trip by UUID.", "scope": "", "scopeKind": ""}, {"name": "TripRead update_trip(trip_id: uuid.UUID, payload: TripUpdate, db: Session = Depends(get_db))", "description": "Handles PUT requests to update an existing trip; supports partial updates.", "scope": "", "scopeKind": ""}, {"name": "Response delete_trip(trip_id: uuid.UUID, db: Session = Depends(get_db))", "description": "Handles DELETE requests to remove a trip by UUID.", "scope": "", "scopeKind": ""}, {"name": "str|None _name_not_blank(cls, v: str | None)", "scope": "TripUpdate", "scopeKind": "class", "description": "unavailable"}], "calls": ["get_db", "select", "select(func.count())", "db.execute", "db.add", "db.commit", "db.refresh", "db.delete"], "search-terms": ["FastAPI trips routes", "SQLAlchemy Trip CRUD", "TripUpdate schema", "trip pagination", "trip date validation", "Trips API endpoints"], "state": 2, "file_id": 11, "knowledge_revision": 43, "git_revision": "dab40099262f9c79ab35527b0724b028609971f2", "revision_history": [{"24": ""}, {"42": "dab40099262f9c79ab35527b0724b028609971f2"}, {"43": "dab40099262f9c79ab35527b0724b028609971f2"}], "ctags": [{"_type": "tag", "name": "TripListResponse", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^class TripListResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TripUpdate", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^class TripUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_apply_trip_sorting", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def _apply_trip_sorting($/", "language": "Python", "typeref": "typename:Select[tuple[Trip]]", "kind": "function", "signature": "( stmt: Select[tuple[Trip]], *, sort_by: Literal[\"created_at\", \"name\"] = \"created_at\", sort_dir: Literal[\"asc\", \"desc\"] = \"desc\", )"}, {"_type": "tag", "name": "_get_trip_or_404", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def _get_trip_or_404(db: Session, trip_id: uuid.UUID) -> Trip:$/", "language": "Python", "typeref": "typename:Trip", "kind": "function", "signature": "(db: Session, trip_id: uuid.UUID)"}, {"_type": "tag", "name": "_name_not_blank", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^    def _name_not_blank(cls, v: str | None) -> str | None:$/", "language": "Python", "typeref": "typename:str|None", "kind": "member", "signature": "(cls, v: str | None)", "scope": "TripUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "create_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def create_trip(payload: TripCreate, db: Session = Depends(get_db)) -> TripRead:$/", "language": "Python", "typeref": "typename:TripRead", "kind": "function", "signature": "(payload: TripCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "delete_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def delete_trip(trip_id: uuid.UUID, db: Session = Depends(get_db)) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "(trip_id: uuid.UUID, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def get_trip(trip_id: uuid.UUID, db: Session = Depends(get_db)) -> TripRead:$/", "language": "Python", "typeref": "typename:TripRead", "kind": "function", "signature": "(trip_id: uuid.UUID, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^    items: list[TripRead] = Field(..., description=\"Trips in the current page\")$/", "language": "Python", "typeref": "typename:list[TripRead]", "kind": "variable", "scope": "TripListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "limit", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^    limit: int = Field(..., description=\"Page size limit used for this response\", ge=1, le=100)$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TripListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "list_trips", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def list_trips($/", "language": "Python", "kind": "function", "signature": "( db: Session = Depends(get_db), limit: int = Query(20, ge=1, le=100, description=\"Maximum number of trips to return\"), offset: int = Query(0, ge=0, description=\"Number of trips to skip\"), sort_by: Literal[\"created_at\", \"name\"] = Query( \"created_at\", description=\"Sort field\", ), sort_dir: Literal[\"asc\", \"desc\"] = Query( \"desc\", description=\"Sort direction\", ), )"}, {"_type": "tag", "name": "offset", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^    offset: int = Field(..., description=\"Offset used for this response\", ge=0)$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TripListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^router = APIRouter(prefix=\"\\/api\\/trips\", tags=[\"Trips\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^    total: int = Field(..., description=\"Total number of trips available (ignores pagination)\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "TripListResponse", "scopeKind": "class"}, {"_type": "tag", "name": "update_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-214723-214732/travel_planner_backend/src/api/routes/trips.py", "pattern": "/^def update_trip(trip_id: uuid.UUID, payload: TripUpdate, db: Session = Depends(get_db)) -> TripR/", "language": "Python", "typeref": "typename:TripRead", "kind": "function", "signature": "(trip_id: uuid.UUID, payload: TripUpdate, db: Session = Depends(get_db))"}], "hash": "85993d281b6dee7f0e64f959d8ccf428", "format-version": 4, "code-base-name": "travel_planner_backend", "filename": "travel_planner_backend/src/api/routes/trips.py", "fields": [{"name": "list[TripRead] items", "scope": "TripListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int limit", "scope": "TripListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "int offset", "scope": "TripListResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/api\\/trips\", tags=[\"Trips\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int total", "scope": "TripListResponse", "scopeKind": "class", "description": "unavailable"}]}